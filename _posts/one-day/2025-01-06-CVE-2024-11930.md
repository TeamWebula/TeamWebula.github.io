---
title: "[CVE-2025-11930] ì·¨ì•½ì  ë¶„ì„ ë³´ê³ ì„œ"
description: "Taskbuilder í”ŒëŸ¬ê·¸ì¸ ë²„ì „ 3.0.6 ì´í•˜ì—ì„œ ë‹¨ì¶• ì½”ë“œì˜ ì†ì„± ê°’ì— ëŒ€í•œ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ë¥¼ ìˆ˜í–‰í•˜ì§€ ì•Šì•„ ë°œìƒí•˜ëŠ” ì €ì¥í˜• í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ… ì·¨ì•½ì "
author: dottak
date: 2025-01-06 14:20:00 +0900
categories: [One-Day ë¶„ì„, WordPress]
tags: [ë¹¡ê³µíŒŸ, ì½˜í…ŒìŠ¤íŠ¸ ë„¤ë·¸ë¼, CVE-2024-11930, XSS, ShortCode]
image: assets/img/wordpress-thumbnail.png
exclude_img: true
---

## ğŸ“Œ Analysis

### 1. ê°œìš”

`CVE-2024-11930` ì·¨ì•½ì ì€ Taskbuilder â€“ WordPress Project & Task Management plugin í”ŒëŸ¬ê·¸ì¸(ì´í•˜, Taskbuilder í”ŒëŸ¬ê·¸ì¸) ë²„ì „ 3.0.6 ì´í•˜ì—ì„œ ë°œìƒí•˜ëŠ” ì €ì¥í˜• í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ… ì·¨ì•½ì ì…ë‹ˆë‹¤.

ì´ í”ŒëŸ¬ê·¸ì¸ì€ í”„ë¡œì íŠ¸ì™€ ì‘ì—…ì„ ê´€ë¦¬í•˜ëŠ” ë„êµ¬ë¡œ, í˜ì´ì§€ë‚˜ ê²Œì‹œê¸€ì— ë‹¨ì¶• ì½”ë“œ(â€™ShortCodeâ€™)ë¥¼ ì‚½ì…í•´ í”„ë¡œì íŠ¸ì˜ ì‘ì—… í˜„í™©ì„ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë•Œ, ë‹¨ì¶• ì½”ë“œ `wppm_tasks` ì— ëŒ€í•œ ìœ íš¨ì„± ê²€ì‚¬ ë° ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ê°€ ë¶ˆì¶©ë¶„í•˜ì—¬ í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ… ì·¨ì•½ì ì´ ë°œìƒí•˜ê²Œ ë©ë‹ˆë‹¤.

### 2. ì·¨ì•½ì  ë¶„ì„

Taskbuilder í”ŒëŸ¬ê·¸ì¸ì˜ ë‹¨ì¶• ì½”ë“œê°€ í¬í•¨ëœ í˜ì´ì§€ë‚˜ ê²Œì‹œê¸€ì— ì ‘ê·¼í•˜ë©´ `/wp-content/plugins/taskbuilder/includes/frontend/wppm_tasks_shortcode.php` íŒŒì¼ì˜ `WPPM_Tasks_Shortcode` í´ë˜ìŠ¤ì—ì„œ `__construct` ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ë©°, ì´í›„ ë©”ì„œë“œì˜ ë¡œì§ì— ë”°ë¼ `wppm_page_inline_script` í•¨ìˆ˜ê°€ í˜¸ì¶œë©ë‹ˆë‹¤.

![image](assets/posts/one-day/2025-01-06/image-001.png)

ì´í›„ `wppm_page_inline_script` í•¨ìˆ˜ëŠ” Javascript ì½”ë“œë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ëŠ”ë°, ì´ ê³¼ì •ì—ì„œ PHPì˜ `echo` í•¨ìˆ˜ë¥¼ í†µí•´ `this->shortcode_attr['project']` ê°’ì´ Javascript ì½”ë“œì— í¬í•¨ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![image](assets/posts/one-day/2025-01-06/image-002.png)

ë”°ë¼ì„œ, í˜ì´ì§€ ì‘ì„± ì‹œ ë‹¨ì¶• ì½”ë“œë¥¼ `[wppm_tasks project='foo']` ë¡œ ì‘ì„±í•  ê²½ìš° í•´ë‹¹ í˜ì´ì§€ì˜ ì‘ë‹µ ë°ì´í„°ëŠ” ë‹¨ì¶• ì½”ë“œì˜ ì†ì„± `project` ì˜ ê°’ `foo` ê°€ Javascript ì½”ë“œì— í¬í•¨ë©ë‹ˆë‹¤.

![image](assets/posts/one-day/2025-01-06/image-003.png)

![image](assets/posts/one-day/2025-01-06/image-004.png)

ë‹¤ë§Œ, ë‹¨ì¶• ì½”ë“œì˜ ì†ì„± `project` ê°’ì´ ì‘ë‹µ ë°ì´í„°ì— í¬í•¨ë  ë•Œ ìœ íš¨ì„± ê²€ì‚¬ì™€ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ê°€ ìˆ˜í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì•…ì˜ì ì¸ Javascript ì½”ë“œê°€ í¬í•¨ëœ ë‹¨ì¶• ì½”ë“œë¡œ í˜ì´ì§€ë¥¼ ì‘ì„±í•˜ë©´ í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ… ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤.

> ì°¸ê³ ë¡œ ì•„ë˜ ë‹¨ì¶• ì½”ë“œëŠ” Javascript ì½”ë“œ ì¤‘ í•¨ìˆ˜ ìŠ¤ì½”í”„ì— í¬í•¨ë©ë‹ˆë‹¤. ì´ì— ì•„ë˜ ë‹¨ì¶• ì½”ë“œì˜ ì†ì„± `project` ê°’ì— í¬í•¨ëœ `alert` í•¨ìˆ˜ëŠ” í•´ë‹¹ í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì–´ì•¼ ë™ì‘í•˜ê²Œ ë©ë‹ˆë‹¤.
> 

```
[wppm_tasks project='foo");alert("XSS']
```

![image](assets/posts/one-day/2025-01-06/image-005.png)

## ğŸ“Œ PoC

1. WordPress ì‚¬ì´íŠ¸ì— Taskbuilder í”ŒëŸ¬ê·¸ì¸ 3.0.6 ì´í•˜ì˜ ë²„ì „ì„ ì„¤ì¹˜ ë° í™œì„±í™”í•©ë‹ˆë‹¤.
    
    ![image](assets/posts/one-day/2025-01-06/image-006.png)
    
2. ê·¸ë‹¤ìŒ Contributor ì´ìƒì˜ ê¶Œí•œì„ ê°€ì§„ ê³„ì •ìœ¼ë¡œ ìƒˆ ê¸€ ì‘ì„± í˜ì´ì§€(`/wp-admin/post-new.php`)ì— ì ‘ì†í•˜ì—¬ ì•„ë˜ì˜ ë‹¨ì¶• ì½”ë“œë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
    
    > ì•„ë˜ `project` ì˜ ì†ì„± ê°’ì€ í•¨ìˆ˜ ìŠ¤ì½”í”„ì— í¬í•¨ë˜ì§€ ì•Šë„ë¡ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
    > 
    
    ```
    [wppm_tasks project='project_attr");}alert(document.cookie);function foo(){alert("']
    ```
    
    ![image](assets/posts/one-day/2025-01-06/image-007.png)
    
3. ì´í›„ í•´ë‹¹ ë‹¨ì¶• ì½”ë“œê°€ í¬í•¨ëœ ê¸€ì— ì ‘ì†í•˜ë©´ í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ… ì·¨ì•½ì ì´ ë°œìƒí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
    ![image](assets/posts/one-day/2025-01-06/image-008.png)
    

## ğŸ“Œ íŒ¨ì¹˜ í™•ì¸

ë‹¨ì¶• ì½”ë“œ ì†ì„± `project` ê°’ì„ ì¶œë ¥í•  ë•Œ, `esc_attr` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ë¥¼ ìˆ˜í–‰í•˜ë„ë¡ íŒ¨ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤. 

> https://plugins.trac.wordpress.org/changeset/3210469/taskbuilder/tags/3.0.7/includes/frontend/wppm_tasks_shortcode.php#file1
> 

![image](assets/posts/one-day/2025-01-06/image-009.png)

ì´ë¥¼ í†µí•´ ë‹¨ì¶• ì½”ë“œì˜ ì†ì„± ê°’ì— í¬í•¨ëœ íŠ¹ìˆ˜ ë¬¸ìë“¤ì´ HTML ì—”í‹°í‹°ë¡œ ë³€í™˜ë˜ì–´ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œì˜ ì‹¤í–‰ì´ ë°©ì§€ë˜ëŠ” ê²ƒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.

![image](assets/posts/one-day/2025-01-06/image-010.png)