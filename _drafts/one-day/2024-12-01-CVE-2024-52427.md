---
title: "[CVE-2024-52427] ì·¨ì•½ì  ë¶„ì„ ë³´ê³ ì„œ"
description: "Event Tickets with Ticket Scanner í”ŒëŸ¬ê·¸ì¸ 2.3.11 ë²„ì „ ì´í•˜ì—ì„œ ë°œê²¬ëœ Server Side Include(SSI) Injection ì·¨ì•½ì ì…ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì€ í•´ë‹¹ í”ŒëŸ¬ê·¸ì¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” Twig í…œí”Œë¦¿ ì—”ì§„ì˜ íŠ¹ìˆ˜ ìš”ì†Œë¥¼ ì ì ˆíˆ í•„í„°ë§í•˜ì§€ ì•Šì•„ ë°œìƒí•˜ë©°, ê¸€ ì“°ê¸° ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ì(`Author` ê¶Œí•œ ì´ìƒ)ê°€ ì•…ì˜ì ì¸ ì½”ë“œë¥¼ ì‚½ì…í•´ ì„œë²„ì— ì‹œìŠ¤í…œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
author: dottak
date: 2024-12-01 21:10:00 +0900
categories: [One-Day ë¶„ì„, WordPress]
tags: [ë¹¡ê³µíŒŸ, ì½˜í…ŒìŠ¤íŠ¸ ë„¤ë·¸ë¼, WordPress, CVE, CVE-2024-52427, Event Tickets with Ticket Scanner]
image: assets/img/wordpress-thumbnail.png
exclude_img: true
---

## ğŸ“Œ Analysis

### 1. ê°œìš”

`CVE-2024-52427`ì€ [Event Tickets with Ticket Scanner](https://wordpress.org/plugins/event-tickets-with-ticket-scanner/)(ì´í•˜, Event Tickets) WordPress í”ŒëŸ¬ê·¸ì¸ 2.3.11 ë²„ì „ ì´í•˜ì—ì„œ ë°œê²¬ëœ Server Side Include(SSI) Injection ì·¨ì•½ì ì…ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì€ í•´ë‹¹ í”ŒëŸ¬ê·¸ì¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” `Twig` í…œí”Œë¦¿ ì—”ì§„ì˜ íŠ¹ìˆ˜ ìš”ì†Œë¥¼ ì ì ˆíˆ í•„í„°ë§í•˜ì§€ ì•Šì•„ ë°œìƒí•˜ë©°, ê¸€ ì“°ê¸° ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ì(`Author` ê¶Œí•œ ì´ìƒ)ê°€ ì•…ì˜ì ì¸ ì½”ë“œë¥¼ ì‚½ì…í•´ ì„œë²„ì— ì‹œìŠ¤í…œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 2. í”ŒëŸ¬ê·¸ì¸ ì„¤ëª…

Event Ticketsì€ WordPress ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì´ë²¤íŠ¸ í‹°ì¼“ì„ ìƒì„±í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” í”ŒëŸ¬ê·¸ì¸ì…ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ì½˜ì„œíŠ¸ ì…ì¥ê¶Œ íŒë§¤ ì‹œ ìƒí’ˆ ë“±ë¡ ë‹¨ê³„ì—ì„œ ì…ì¥ê¶Œ ì •ë³´ë¥¼ ì…ë ¥í•˜ë©´ ìƒí’ˆì„ êµ¬ë§¤í•œ ê³ ê°ì—ê²Œ ìƒí’ˆ ì •ë³´ê°€ í¬í•¨ëœ í‹°ì¼“ì´ ìë™ìœ¼ë¡œ ë¶€ì—¬ë©ë‹ˆë‹¤.

![ìƒí’ˆ ë“±ë¡ ì‹œ í‹°ì¼“ ì •ë³´ ì…ë ¥](assets/posts/one-day/2024-12-01/image-001.png)

*ìƒí’ˆ ë“±ë¡ ì‹œ í‹°ì¼“ ì •ë³´ ì…ë ¥*

![ìƒí’ˆ ì£¼ë¬¸ ì™„ë£Œ í™”ë©´ ë‚´ í‹°ì¼“ ì •ë³´](assets/posts/one-day/2024-12-01/image-002.png)

*ìƒí’ˆ ì£¼ë¬¸ ì™„ë£Œ í™”ë©´ ë‚´ í‹°ì¼“ ì •ë³´*

ìœ„ ìƒí’ˆ ì£¼ë¬¸ ì™„ë£Œ í™”ë©´ ë‚´ í‹°ì¼“ ì •ë³´ë¥¼ í´ë¦­í•  ê²½ìš° ìƒí’ˆ êµ¬ë§¤ ì •ë³´ì™€ QR ì½”ë“œê°€ ë‹´ê¸´ í‹°ì¼“ì„ ë°œê¸‰ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![image.png](assets/posts/one-day/2024-12-01/image-003.png)

ë˜í•œ QR ì½”ë“œë¥¼ í†µí•œ í‹°ì¼“ ìŠ¤ìº” ê¸°ëŠ¥ì„ ì œê³µí•˜ë©°, í‹°ì¼“ í…œí”Œë¦¿ ì»¤ìŠ¤í„°ë§ˆì´ì§•, ì´ë²¤íŠ¸ ê´€ë¦¬, ê²°ì œ ì²˜ë¦¬ ë“± ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

![í‹°ì¼“ ìŠ¤ìºë„ˆ 1](assets/posts/one-day/2024-12-01/image-004.png)

*í‹°ì¼“ ìŠ¤ìºë„ˆ 1*

![í‹°ì¼“ ìŠ¤ìºë„ˆ 2](assets/posts/one-day/2024-12-01/image-005.png)

*í‹°ì¼“ ìŠ¤ìºë„ˆ 2*

### 3. ì·¨ì•½ì  ë¶„ì„

Event Tickets í”ŒëŸ¬ê·¸ì¸ì€ í…œí”Œë¦¿ ì»¤ìŠ¤í„°ë§ˆì´ì§• ê¸°ëŠ¥ì„ í†µí•´ í‹°ì¼“ í˜ì´ì§€ë¥¼ ê¾¸ë°€ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ ì»¤ìŠ¤í„°ë§ˆì´ì§• ê¸°ëŠ¥ì€ Event Tickets ì„¤ì • ë©”ë‰´(`/wp-admin/admin.php?page=event-tickets-with-ticket-scanner`)ì˜ â€˜`Options`â€™ ë‚´ í‹°ì¼“ í…œí”Œë¦¿ ì„¤ì •ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

![Event Tickets ì„¤ì • ë©”ë‰´](assets/posts/one-day/2024-12-01/image-006.png)

*Event Tickets ì„¤ì • ë©”ë‰´*

![Event Tickets ì„¤ì • ë©”ë‰´ ë‚´ í‹°ì¼“ í˜ì´ì§€ í…œí”Œë¦¿ ì„¤ì •](assets/posts/one-day/2024-12-01/image-007.png)

*Event Tickets ì„¤ì • ë©”ë‰´ ë‚´ í‹°ì¼“ í˜ì´ì§€ í…œí”Œë¦¿ ì„¤ì •*

ì´ ì„¤ì •ì—ì„œëŠ” `HTML` ê³¼ `Twig` í…œí”Œë¦¿ ë¬¸ë²•ì„ ì‚¬ìš©í•˜ì—¬ í‹°ì¼“ì˜ ë””ìì¸ê³¼ ë‚´ìš©ì„ ììœ ë¡­ê²Œ ìˆ˜ì •í•  ìˆ˜ ìˆë„ë¡ í—ˆìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. 

í•˜ì§€ë§Œ Event Tickets í”ŒëŸ¬ê·¸ì¸ì€ ì‚¬ìš©ìê°€ ì…ë ¥í•œ `Twig` í…œí”Œë¦¿ ì½”ë“œë¥¼ ì ì ˆíˆ ê²€ì¦í•˜ì§€ ì•Šì•„ ì•…ì˜ì ì¸ ì½”ë“œê°€ ì‹¤í–‰ë  ìˆ˜ ìˆëŠ” ì·¨ì•½ì ì´ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, í•´ë‹¹ í”ŒëŸ¬ê·¸ì¸ì˜ ì„¤ì • ë©”ë‰´ëŠ” ê¸€ì“´ì´(`Author`) ìˆ˜ì¤€ì˜ ë‚®ì€ ì ‘ê·¼ ê¶Œí•œìœ¼ë¡œë„ ì´ìš©í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì·¨ì•½ì  ì•…ìš©ì˜ ìœ„í—˜ì„±ì´ ë†’ìŠµë‹ˆë‹¤. 

![ê¸€ì“´ì´(â€™Authorâ€™) ê¶Œí•œì„ ê°€ì§„ ì‚¬ìš©ì Event Tickets ì„¤ì • ë©”ë‰´ ì ‘ê·¼ í™”ë©´(í‹°ì¼“ í˜ì´ì§€ í…œí”Œë¦¿ ì„¤ì •)](assets/posts/one-day/2024-12-01/image-008.png)

*ê¸€ì“´ì´(â€™Authorâ€™) ê¶Œí•œì„ ê°€ì§„ ì‚¬ìš©ì Event Tickets ì„¤ì • ë©”ë‰´ ì ‘ê·¼ í™”ë©´(í‹°ì¼“ í˜ì´ì§€ í…œí”Œë¦¿ ì„¤ì •)*

ë”°ë¼ì„œ, WordPressì˜ ê¸€ì“´ì´(`Author`) ê¶Œí•œì€ ì¼ë°˜ì ìœ¼ë¡œ ì½˜í…ì¸  ì‘ì„±ê³¼ í¸ì§‘ë§Œ ê°€ëŠ¥í•˜ì§€ë§Œ, Event Tickets í”ŒëŸ¬ê·¸ì¸ ì„¤ì • ë©”ë‰´ì— ì ‘ê·¼í•  ìˆ˜ ìˆì–´ í…œí”Œë¦¿ ì½”ë“œì— ì•…ì˜ì ì¸ ì½”ë“œë¥¼ ì‚½ì…í•˜ì—¬ ì‹œìŠ¤í…œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ“Œ PoC

### 1. PoC í™˜ê²½ ì…‹íŒ…

`CVE-2024-52427` ì·¨ì•½ì ì„ PoC í•˜ê¸° ìœ„í•´ì„œëŠ” ìš°ì„ , WordPressì˜`WooCommerce` í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ë¥¼ í†µí•´ ìŠ¤í† ì–´ë¥¼ ê°œì„¤í•´ì•¼ í•©ë‹ˆë‹¤.

`WooCommerce` í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ë¥¼ ì™„ë£Œí•œ ë’¤, ìŠ¤í† ì–´ ì„¤ì •ì„ í†µí•´ WordPress ì‚¬ì´íŠ¸ì˜ ìŠ¤í† ì–´ë¥¼ í™œì„±í™” í•©ë‹ˆë‹¤. 

![image.png](assets/posts/one-day/2024-12-01/image-009.png)

ì´í›„ `event-tickets-with-ticket-scanner` í”ŒëŸ¬ê·¸ì¸ `2.3.11` ë²„ì „ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤. ê·¸ ë‹¤ìŒ ì–´ë“œë¯¼ í˜ì´ì§€ì—ì„œ í”ŒëŸ¬ê·¸ì¸ ì„¤ì • í˜ì´ì§€(`/wp-admin/admin.php?page=event-tickets-with-ticket-scanner`)ë¡œ ì´ë™í•©ë‹ˆë‹¤.

> í•´ë‹¹ í”ŒëŸ¬ê·¸ì¸ íŒŒì¼ì€ `plugins/event-tickets-with-ticket-scanner.2.3.11.zip` ê²½ë¡œì— ìˆìŠµë‹ˆë‹¤.
> 

ë§Œì•½, `event-tickets-with-ticket-scanner` í”ŒëŸ¬ê·¸ì¸ ì„¤ì • í˜ì´ì§€ ì ‘ê·¼ ì‹œ ì•„ë˜ì˜ ê²½ê³ ì°½ì´ ë‚˜íƒ€ë‚  ê²½ìš° ê³ ìœ ì£¼ì†Œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.

![image.png](assets/posts/one-day/2024-12-01/image-010.png)

ê³ ìœ ì£¼ì†Œ ì„¤ì •ì€ ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•©ë‹ˆë‹¤.

![image.png](assets/posts/one-day/2024-12-01/image-011.png)

### 2. íŠ¸ë¦¬ê±° ì¤€ë¹„

ì ‘ê·¼ ê¶Œí•œì´ ê¸€ì“´ì´(`Author`)ì¸ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ì„ ìˆ˜í–‰í•œ í›„ Event Tickets ì„¤ì • ë©”ë‰´(`/wp-admin/admin.php?page=event-tickets-with-ticket-scanner`)ë¡œ ì´ë™í•˜ì—¬ í‹°ì¼“ í…œí”Œë¦¿ ì„¤ì • ì˜ì—­ìœ¼ë¡œ ì´ë™ í•©ë‹ˆë‹¤.

![image.png](assets/posts/one-day/2024-12-01/image-012.png)

í˜„ì¬ ìœ„ì™€ ê°™ì´ ì„¤ì •ëœ í…œí”Œë¦¿ ë‚´ìš©ì€ ì•„ë˜ì˜ í˜•ì‹ìœ¼ë¡œ í‹°ì¼“ í˜ì´ì§€ë¥¼ ì¶œë ¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.

![image.png](assets/posts/one-day/2024-12-01/image-013.png)

ì´í›„ í…œí”Œë¦¿ ë‚´ìš©ì„ ì•„ë˜ì˜ ì½”ë“œë¡œ ì‘ì„±í•©ë‹ˆë‹¤. í•´ë‹¹ ì½”ë“œëŠ” WordPress ì„œë²„ì˜ ì‹œìŠ¤í…œì— `cat /etc/passwd` ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.

```
{ { ['cat /etc/passwd'] | filter('system') } }
```


![image.png](assets/posts/one-day/2024-12-01/image-014.png)

### 3. ì·¨ì•½ì  ë°œìƒ

ê·¸ ë‹¤ìŒ í‹°ì¼“ í˜ì´ì§€ë¥¼ ìš”ì²­ í•  ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ ëª…ë ¹ì–´ `cat /etc/passwd` ì˜ ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> í‹°ì¼“ í˜ì´ì§€ì˜ ìš”ì²­ì€ â€˜[ğŸ“ŒÂ Analysis > 2. í”ŒëŸ¬ê·¸ì¸ ì„¤ëª…](#2-í”ŒëŸ¬ê·¸ì¸-ì„¤ëª…)â€™ ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> 

![image.png](assets/posts/one-day/2024-12-01/image-015.png)

## ğŸ“ŒÂ PoC ì½”ë“œ êµ¬í˜„ ë° ì‹¤í–‰

### 1. í™˜ê²½ ì…‹íŒ…

ì•„ë˜ì˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ poc í´ë”ë¡œ ì´ë™í•œ ë’¤, pythonì˜ ê°€ìƒí™˜ê²½(`venv`)ì„ ìƒì„± ë° ì‹¤í–‰í•˜ê³  í•„ìš”í•œ ëª¨ë“ˆì„ ì„¤ì¹˜í•©ë‹ˆë‹¤.

```bash
$ cd poc
$ python3 -m venv venv
$ source venv/bin/activate
(venv) $ pip install -r requirements.txt
```

![image.png](assets/posts/one-day/2024-12-01/image-016.png)

### 2. poc.py ì½”ë“œ ìˆ˜ì •

`poc.py` íŒŒì¼ì„ ì—´ì–´ ì½”ë“œ í•˜ë‹¨ì— WordPress ì£¼ì†Œì™€ ê´€ë¦¬ì ê³„ì •ì„ ì…ë ¥í•©ë‹ˆë‹¤.

![image.png](assets/posts/one-day/2024-12-01/image-017.png)

### 3. PoC ìˆ˜í–‰

ì´í›„ ì•„ë˜ì˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ PoCë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.

```bash
(venv) $ python poc.py
```

![image.png](assets/posts/one-day/2024-12-01/image-018.png)

ë˜í•œ, ìœ„ ì¶œë ¥ëœ ë¡œê·¸ ì¤‘ Ticket URLì— ì ‘ì†í•  ê²½ìš° ì•„ë˜ì™€ ê°™ì´ ëª…ë ¹ì–´ `cat /etc/passwd` ì˜ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì‹¤ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

![image.png](assets/posts/one-day/2024-12-01/image-019.png)

## ğŸ“ŒÂ íŒ¨ì¹˜í™•ì¸

> âš ï¸ ë³¸ ë‚´ìš©ì€ CVE-2024-52427 ì œë³´ìì˜ ì›ë³¸ PoC ì½”ë“œë¥¼ ì§ì ‘ í™•ì¸í•  ìˆ˜ ì—†ì–´, CVE ì œë³´ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì¬í˜„í•œ ê²°ê³¼ë¥¼ ì •ë¦¬í•œ ê²ƒì…ë‹ˆë‹¤.

[CVE-2024-52427](https://www.cve.org/CVERecord?id=CVE-2024-52427) ì •ë³´ì— ë”°ë¥´ë©´ í•´ë‹¹ ì·¨ì•½ì ì€ Event Tickets í”ŒëŸ¬ê·¸ì¸ `2.3.11` ì´í•˜ ë²„ì „ì—ì„œ ì˜í–¥ì„ ë°›ìœ¼ë©°, `2.3.12` ì´í›„ ë²„ì „ì—ì„œëŠ” ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ”ë‹¤ê³  ë‚˜ì™€ìˆìŠµë‹ˆë‹¤.

![image.png](assets/posts/one-day/2024-12-01/image-020.png)

ê·¸ëŸ¬ë‚˜ í”ŒëŸ¬ê·¸ì¸ ê°œë°œ ê¸°ë¡ì„ í™•ì¸í•˜ê³  í•´ë‹¹ ì·¨ì•½ì ì— ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ” ë²„ì „ì˜ ìƒìœ„ ë²„ì „ì¸ `2.4.0` ì„ ëŒ€ìƒìœ¼ë¡œ PoCë¥¼ ìˆ˜í–‰í•œ ê²°ê³¼, íŒ¨ì¹˜ëŠ” `2.4.1` ë²„ì „ë¶€í„° ì´ë£¨ì–´ì§„ ê²ƒì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤.

> [https://plugins.trac.wordpress.org/changeset/3172740/event-tickets-with-ticket-scanner?old=3160714&old_path=%2Fevent-tickets-with-ticket-scanner#file1690](https://plugins.trac.wordpress.org/changeset/3172740/event-tickets-with-ticket-scanner?old=3160714&old_path=%2Fevent-tickets-with-ticket-scanner#file1690)
> 

![/wp-content/plugins/event-tickets-with-ticket-scanner/sasoEventtickets_Options.php](assets/posts/one-day/2024-12-01/image-021.png)

*/wp-content/plugins/event-tickets-with-ticket-scanner/sasoEventtickets_Options.php*

ìœ„ ì½”ë“œ ë‚´ìš©ì€ Event Tickets í”ŒëŸ¬ê·¸ì¸ì˜ ì„¤ì • ë©”ë‰´ ì¤‘ ì•„ë˜ ì ‘ê·¼ê³¼ ê´€ë ¨ëœ ì„¤ì •ì…ë‹ˆë‹¤.

![image.png](assets/posts/one-day/2024-12-01/image-022.png)

ì¦‰, Event Tickets í”ŒëŸ¬ê·¸ì¸ì˜ ì„¤ì • ë©”ë‰´ì˜ ì ‘ê·¼ ê¶Œí•œì„ ê´€ë¦¬ì(`Administrator`) ë˜ëŠ” ì ‘ê·¼ ì„¤ì •ì— ì„ íƒëœ ì—­í• ì—ë§Œ í• ë‹¹í•˜ëŠ” ê²ƒì„ ê¸°ë³¸ ê°’(Default)ìœ¼ë¡œ ì„¤ì •í•˜ê³  ìˆìŠµë‹ˆë‹¤. 

ë”°ë¼ì„œ, í•´ë‹¹ ì·¨ì•½ì ì€ Event Tickets í”ŒëŸ¬ê·¸ì¸ ì„¤ì • ë©”ë‰´ì˜ ê¸°ë³¸ ì ‘ê·¼ ê¶Œí•œì˜ ë³€ê²½ì„ í†µí•´ íŒ¨ì¹˜ ë˜ì—ˆìŠµë‹ˆë‹¤.